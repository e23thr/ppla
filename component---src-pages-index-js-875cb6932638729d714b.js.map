{"version":3,"file":"component---src-pages-index-js-875cb6932638729d714b.js","mappings":"4KAyEA,UAhEkB,WAYhB,MAA0BA,EAAAA,SAAe,IAAlCC,EAAP,KAAcC,EAAd,KAEMC,EAAc,SAAdA,EAAeC,IACnBC,EAAAA,EAAAA,IAjBc,GAiBND,EAjBM,IAiBuBE,MAAK,YAAe,IAAZC,EAAW,EAAXA,KAC3CL,GAAS,SAAAD,GAAK,wBAAQA,IAAR,OAAkBM,EAAKA,UACjCA,EAAKC,MAnBG,GAmBMJ,EAnBN,IAoBVD,EAAYC,EAAO,OAYzBJ,EAAAA,WAAgB,WACdE,EAAS,IACTC,EAAY,KACX,IAEH,IAAMM,EAAW,SAACC,IAChBC,EAAAA,EAAAA,IAAWD,GAAIJ,MAAK,WAClBJ,EAAS,IACTC,EAAY,OAIhB,OACE,4BACE,qCACA,uBAAKS,UAAU,+CACb,qBAAGA,UAAU,kBAAkBC,KAAK,UAApC,cAEDZ,EAAMa,OAAS,GACd,uBAAKF,UAAU,0CACb,0BAAQA,UAAU,iBAAiBG,QA3BpB,WACrBC,QAAQC,IAAIhB,EAAMiB,KAAI,SAAAC,GAAI,OAAIR,EAAAA,EAAAA,IAAWQ,EAAKT,QAAMJ,MAAK,WACvDJ,EAAS,IACTC,EAAY,QAwBR,oBAGJ,uBAAKS,UAAU,cAEXX,EAAMiB,KAAI,SAACC,EAAMC,GAAP,OACR,gBAAC,IAAD,CAAaC,OAAQC,EAAAA,GAAQC,UAAWJ,EAAMK,IAAKJ,EAAKX,SAAUA","sources":["webpack://pla-s-tools/./src/pages/index.js"],"sourcesContent":["import { graphql, useStaticQuery } from \"gatsby\";\nimport * as React from \"react\";\nimport AddressCard from \"../component/address-card\";\nimport { getList, setApiUrl, deleteItem } from \"../helpers\";\n\nimport { SENDER } from \"../helpers\";\n\nconst PAGE_SIZE = 25;\n// markup\nconst IndexPage = () => {\n\n  // const apiData = useStaticQuery(graphql`\n  //   query MyQuery {\n  //     api {\n  //       appScriptUrl\n  //     }\n  //   }\n  // `);\n\n  // setApiUrl(apiData.api.appScriptUrl);\n\n  const [items, setItems] = React.useState([]);\n\n  const getAllItems = (page) => {\n    getList(page * PAGE_SIZE, PAGE_SIZE).then(({ data }) => {\n      setItems(items => [...items, ...data.data]);\n      if (data.total > (page * PAGE_SIZE) + PAGE_SIZE) {\n        getAllItems(page + 1);\n      }\n    });\n  };\n\n  const deleteAllItems = () => {\n    Promise.all(items.map(item => deleteItem(item.id))).then(() => {\n      setItems([]);\n      getAllItems(0);\n    });\n  };\n\n  React.useEffect(() => {\n    setItems([]);\n    getAllItems(0);\n  }, []);\n\n  const onDelete = (id) => {\n    deleteItem(id).then(() => {\n      setItems([]);\n      getAllItems(0);\n    });\n  };\n\n  return (\n    <main>\n      <title>Form</title>\n      <div className=\"no-print d-flex justify-content-center my-3\">\n        <a className=\"btn btn-primary\" href=\"./form\">กรอกฟอร์ม</a>\n      </div>\n      {items.length > 0 && (\n        <div className=\"no-print d-flex justify-content-center\">\n          <button className=\"btn btn-danger\" onClick={deleteAllItems}>ลบรายการทั้งหมด</button>\n        </div>\n      )}\n      <div className=\"print-page\">\n        {\n          items.map((item, idx) => (\n            <AddressCard sender={SENDER} recipient={item} key={idx} onDelete={onDelete} />\n          ))\n        }\n      </div>\n    </main>\n  );\n};\n\nexport default IndexPage;\n"],"names":["React","items","setItems","getAllItems","page","getList","then","data","total","onDelete","id","deleteItem","className","href","length","onClick","Promise","all","map","item","idx","sender","SENDER","recipient","key"],"sourceRoot":""}